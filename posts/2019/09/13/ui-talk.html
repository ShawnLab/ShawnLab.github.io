<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>UI 自动化趟坑碎碎念 | 醉翁之翼</title>
    <meta name="generator" content="VuePress 1.9.9">
    <meta name="description" content="有的路，你必须一个人走，这不是孤独，而是选择！">
    <link rel="preload" href="/assets/css/0.styles.9f0e0dd9.css" as="style"><link rel="preload" href="/assets/js/app.634d442c.js" as="script"><link rel="preload" href="/assets/js/7.1d3164ec.js" as="script"><link rel="preload" href="/assets/js/31.3460a119.js" as="script"><link rel="prefetch" href="/assets/js/1.c5a48fea.js"><link rel="prefetch" href="/assets/js/10.8a3e303a.js"><link rel="prefetch" href="/assets/js/11.523b72b9.js"><link rel="prefetch" href="/assets/js/12.2de233bb.js"><link rel="prefetch" href="/assets/js/13.971d944f.js"><link rel="prefetch" href="/assets/js/14.f5114355.js"><link rel="prefetch" href="/assets/js/15.1da13e54.js"><link rel="prefetch" href="/assets/js/16.b8b0c36e.js"><link rel="prefetch" href="/assets/js/17.808a148b.js"><link rel="prefetch" href="/assets/js/18.e6665f55.js"><link rel="prefetch" href="/assets/js/19.3ea98471.js"><link rel="prefetch" href="/assets/js/20.df28ef85.js"><link rel="prefetch" href="/assets/js/21.d00d9e7b.js"><link rel="prefetch" href="/assets/js/22.4706d8a9.js"><link rel="prefetch" href="/assets/js/23.68ab7020.js"><link rel="prefetch" href="/assets/js/24.47a775e9.js"><link rel="prefetch" href="/assets/js/25.9d3d7cb3.js"><link rel="prefetch" href="/assets/js/26.cc1a3178.js"><link rel="prefetch" href="/assets/js/27.dbdc503e.js"><link rel="prefetch" href="/assets/js/28.67a435e5.js"><link rel="prefetch" href="/assets/js/29.61df9bec.js"><link rel="prefetch" href="/assets/js/3.82789a6d.js"><link rel="prefetch" href="/assets/js/30.dd28c3bc.js"><link rel="prefetch" href="/assets/js/32.0caecbca.js"><link rel="prefetch" href="/assets/js/33.4a9f0a9a.js"><link rel="prefetch" href="/assets/js/34.2237d027.js"><link rel="prefetch" href="/assets/js/35.1c974d0d.js"><link rel="prefetch" href="/assets/js/36.259ac2db.js"><link rel="prefetch" href="/assets/js/37.c50fdf42.js"><link rel="prefetch" href="/assets/js/4.875f5afe.js"><link rel="prefetch" href="/assets/js/5.6be0c568.js"><link rel="prefetch" href="/assets/js/6.97ff8652.js"><link rel="prefetch" href="/assets/js/8.ba14a9d9.js"><link rel="prefetch" href="/assets/js/9.6d0d7519.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9f0e0dd9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          醉翁之翼
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/" class="navbar-link" data-v-e4145d0a>
            首页
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            文章
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          UI 自动化趟坑碎碎念
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2019-09-13
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/posts/2019/08/13/httprunner.html" class="post-link" data-v-4e23451f>
      上一篇 : HttpRunner 学习笔记
    </a> <a href="/posts/2020/05/18/tmux.html" class="post-link" data-v-4e23451f>
      下一篇 : 优雅高效的使用 Tmux
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><blockquote><p>本文转自<a href="https://www.jianshu.com/p/0fc9fc5f42e9" target="_blank" rel="noopener noreferrer">来自地球的专项测试<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，经过排版整理有删改，技术上降低维护成本的方法加入了自己的总结。</p></blockquote> <h2 id="如何体现真正价值"><a href="#如何体现真正价值" class="header-anchor">#</a> 如何体现真正价值</h2> <blockquote><p>让 UI 自动化测试验证 UI, 利用图片比较去做自动验证，甚至利用截图定位按钮，真是找死的节奏呀。 现在我带大家认识下它的真正价值。</p></blockquote> <h3 id="_1-验证逻辑而非-ui"><a href="#_1-验证逻辑而非-ui" class="header-anchor">#</a> 1. 验证逻辑而非 UI</h3> <p>UI 的验证会引入大量的不稳定因素。换句话说，像当年的测试大牛段念说的，你跑过了 UI 自动化，你就相信没问题了吗？不会相信，原因是啥？因为聪明的你会发现，你验证的东西越多，例如界面的每个按钮，颜色，排布，互联网应用变化最大的就是 UI, 你的用例就越不稳定，所以你最终肯定不会验证全部 UI。那结果就是 &quot;然并卵&quot; 了，你根本不会相信这个用例真的通过了。因此给大家定个 UI 自动化能做的，验证逻辑（另外一种说法，说这种叫功能自动化）。什么叫验证逻辑？例如验证 QQ 是否登录成功，验证到了好友列表，就是登录成功，甚至有登录成功的日志都可以，怎么稳定怎么行。</p> <h3 id="_2-代替大量的-ui-重复操作"><a href="#_2-代替大量的-ui-重复操作" class="header-anchor">#</a> 2. 代替大量的 UI 重复操作</h3> <p>简单来说就是 UI 自动化你要投入 5 元，只是执行 4 次，每次赚 5 毛的话，那你还亏 3 元的问题。什么时候会大量呢？像手 Q, 编译百个市场的包，每个包要验证核心功能。或者像性能 UI 自动化监控，同一个用例为了多次采样，也会执行多次。还有每日构建，集成，都可以。关键点就是用次数来增加价值，UI 自动化能帮你确保不出死人的问题，如登录不了，登录了又卡死，或者是监控 UI 之外的其他，如性能。这些都有机会让其价值高于成本的。</p> <h2 id="最大难点-维护"><a href="#最大难点-维护" class="header-anchor">#</a> 最大难点：维护</h2> <p>无间道：出来混，迟早要还的。 这句话，最好用来说明，为什么自动化测试构造得越快越随便，未来的维护成本也就越大。更甚者，脚本依赖录制得来的，也是找死的节奏。 无数的故事告诉我，很多 UI 自动化都是死在一开始就写或者录一堆脚本，结果每天都要花大量时间排查错误，错误有脚本错误，有功能的变更，有 Bug，甚至问题是随机出现的，但是无论你的问题或者是功能的问题，反正你排查错误的时间是花进去了，哪怕你不用改脚本。所以这里看来，要解决维护的难点，终极招数就是不要碰 UI 自动化。其实很多大牛都是说不要做 UI 自动化的，或者这个事情不是最高优先级，但是现实是，大家都做了，优先级还不低。所以我当然不说不做了，要做就只能要狠狠地干一场，要成功，不要失败。下面给大家有两点建议，一是策略，二是技术。</p> <h3 id="策略上"><a href="#策略上" class="header-anchor">#</a> 策略上</h3> <p>维护成本的控制，脚本要慢慢上，先做核心的 BVT，人均维护的脚本 1~2 个，定目标，如稳定运营 1 个月，后面增加的脚本要在测试环境稳定跑上一周，才能切换到正式环境。 组织培训，知识分享，分享写自动化遇到的坑，沉淀最佳的实践，让大家知道写 UI 自动化也是在自我提升，而不是简单的工作任务。</p> <h3 id="技术上"><a href="#技术上" class="header-anchor">#</a> 技术上</h3> <p>降低维护成本的方法</p> <ol><li><p><strong>不要硬编码</strong>，脚本里不要有绝对坐标，图像识别这些，这些都是不稳定的因素。可靠些的方法是获取相邻控件的坐标，然后减去或加上一个比较小的 px 值，再点击计算后的相对坐标即可。</p></li> <li><p><strong>不要依赖偶然性编程</strong>，直接的 sleep 就是 UI 自动化的稳定性的克星，绝对不能有。可以封装一个 timeout 的类，里面包含重试和 sleep 的策略优化等待。</p></li> <li><p><strong>使用 PageObjects 模式</strong>，整体思想是分层，让不同层去做不同类型的事情，让代码结构清晰，增加复用性，实现用例和元素分离。</p></li> <li><p><strong>动态界面静态解析</strong>，有那么一些界面通过 UI Automator Viewer 抓取是会报错的，通过直接点击元素的方法速度也很慢，可以通过解析 Source 的 xml 获取到 bounds 计算相对座标并点击，这样操作更稳定更快。</p></li> <li><p><strong>通过分 Step 的脚本化繁为简</strong>，UI 自动化脚本都有个特色～长！一个脚本通常我们希望验证好几点，登录，打开聊天窗口就不容易了，因此除了验证发消息，我们还希望可以发图，发表情，那么这个时候，最好可以把用例分割成几个 Step。出了问题，就集中排查某个 Step 的日志就 OK 了。补充一下， 大家肯定想个一个问题，每个用例都要独立的，要互不影响，重新登录，为了稳定，多补点时间我不在意，但是现实你又发现这些时间会增加用例出错之后的修复，验证的时间成本。所以 “分 Step” 无疑意思是给大家一个合并用例来提升用例执行速度，但是又不影响用例与用例之间的独立性。</p></li></ol> <h2 id="文章参考"><a href="#文章参考" class="header-anchor">#</a> 文章参考</h2> <p><a href="https://testerhome.com/topics/15937" target="_blank" rel="noopener noreferrer">浅谈如何提高自动化测试的稳定性和可维护性 (pytest&amp;allure)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://testerhome.com/topics/19900" target="_blank" rel="noopener noreferrer">UI 自动化到底要不要用 Page Object 模式？(续 - 深入了解 PO 模式，并改造 PO 模式)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://cloud.tencent.com/developer/article/1006108" target="_blank" rel="noopener noreferrer">小心！做 UI 自动化一定要跨过这些坑<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://testerhome.com/topics/20469#reply7" target="_blank" rel="noopener noreferrer">Airtest 增加了观察者函数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2019-09-13
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/posts/2019/08/13/httprunner.html" class="post-link" data-v-4e23451f>
      上一篇 : HttpRunner 学习笔记
    </a> <a href="/posts/2020/05/18/tmux.html" class="post-link" data-v-4e23451f>
      下一篇 : 优雅高效的使用 Tmux
    </a></section></section> <!----></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" data-v-9d847660><img src="/img/avatar.jpg" alt="醉翁之翼" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      醉翁之翼
    </section> <section class="info-desc" data-v-9d847660>Happy Coding<br/>Happy Life</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="ShenZhen City, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>ShenZhen City, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          ShenZhen City, China
        </span></span></section> <!----> <section data-v-9d847660><a href="mailto:mcomax@outlook.com" title="mcomax@outlook.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>mcomax@outlook.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          mcomax@outlook.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/ShawnLab" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: ShawnLab" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: ShawnLab</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a><a href="http://www.linkedin.com/in/mcomax" target="_blank" class="sns-link" data-v-9d847660><span title="LinkedIn: mcomax" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>LinkedIn: mcomax</title><use xlink:href="#icon-linkedin" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/posts/2019/09/13/ui-talk.html#如何体现真正价值">如何体现真正价值</a><ul><li><a href="/posts/2019/09/13/ui-talk.html#_1-验证逻辑而非-ui">1. 验证逻辑而非 UI</a></li><li><a href="/posts/2019/09/13/ui-talk.html#_2-代替大量的-ui-重复操作">2. 代替大量的 UI 重复操作</a></li></ul></li><li><a href="/posts/2019/09/13/ui-talk.html#最大难点-维护">最大难点：维护</a><ul><li><a href="/posts/2019/09/13/ui-talk.html#策略上">策略上</a></li><li><a href="/posts/2019/09/13/ui-talk.html#技术上">技术上</a></li></ul></li><li><a href="/posts/2019/09/13/ui-talk.html#文章参考">文章参考</a></li></ul></div></div> <!----></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/ShawnLab" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: ShawnLab" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: ShawnLab</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a><a href="http://www.linkedin.com/in/mcomax" target="_blank" class="sns-link" data-v-1375e54c><span title="LinkedIn: mcomax" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>LinkedIn: mcomax</title><use xlink:href="#icon-linkedin" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <p class="footer-text" data-v-1375e54c><span data-v-1375e54c>Powered by </span> <a href="https://github.com/vuejs/vuepress" target="_blank" data-v-1375e54c>
      VuePress
    </a> <span data-v-1375e54c> | </span> <a href="https://github.com/meteorlxy/vuepress-theme-meteorlxy" target="_blank" data-v-1375e54c>
        meteorlxy
      </a></p> <!----></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.634d442c.js" defer></script><script src="/assets/js/7.1d3164ec.js" defer></script><script src="/assets/js/31.3460a119.js" defer></script>
  </body>
</html>
